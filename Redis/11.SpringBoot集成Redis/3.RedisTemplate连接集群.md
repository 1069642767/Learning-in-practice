# RedisTemplate连接集群

- 启动Redis集群6台实例

- 第一次改写YML

  ```yaml
  # ===========================redis集群===========================
  spring.redis.password=123456
  # 获取失败 最大重定向次数
  spring.redis.cluster.max-redirects=3
  spring.redis.lettuce.pool.max-active=8
  spring.redis.1ettuce.pool.max-wait=-1ms
  spring.redis.1ettuce.pool.max-idle=8
  spring.redis.lettuce.pool.min-idle=0
  spring.redis.cluster.nodes=192.168.111.175:6381,192.168.111.175:6382,192.168.111.176:6383,192.168.111.176:6384
  ```


- 直接通过微服务访问Redis集群

  一切正常 （http://localhost:7777/swagger-ui.html）

- $\textcolor{red}{\large 问题来了}$

  人为模拟，master-6381机器意外宕机，手动shutdown

  先对redis集群用命令的方式，手动验证各种读写命令，看看6384是否上位

  Redis Cluster集群能自动感知并自动完成主备切换，对应的slave6384会被选举为新的master节点

  微服务客户端再次读写访问试试

  ​





