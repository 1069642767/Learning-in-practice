# 缓存击穿

### 是什么

大量请求同时查询一个key时，此时这个key正好失效了，就会导致大量的请求都打到数据库，<font color = 'red'>简单点就是热点key突然失效了，暴打MySQL</font>

<font color = 'gren'>缓存穿透和缓存击穿是完全不同的东西</font>

### 危害

会造成某一时刻数据库请求量过大，压力剧增；一般技术部门需要知道热点key是哪些，做到心里有数防止击穿。

### 解决

缓存击穿 -> 热点key失效-> 今天互斥更新、随机退避、差异失效时间

热点key失效：时间到了自然清除但还是被访问到，delete掉的key，刚好又被访问到

方案一：差异失效时间，对于访问频繁的热点key，干脆就不设置过期时间

<font color = 'red'>方案二：互斥更新，采用双检加锁策略</font>

多个线程同时去查询数据库的这条数据，那么我们可以在第一个查询数据的请求上使用一个互斥锁来锁住它。其他的线程走到这一步拿不到锁就等着，等第一个线程查询到了数据，然后做缓存。后面的线程进来发现已经有缓存了，就直接走缓存























