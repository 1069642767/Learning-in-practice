### redis过期键的删除策略

如果一个键是过期的，那它到了过期时间之后是不是马上就从内存中被删除了呢？

如果不是，那过期后到底什么时候被删除呢？是什么操作？

### redis三种删除策略

1. #### 立即删除/定时删除

   立即删除能保证内存中数据的最大新鲜度，因为它保证过期键值会在过期后马上被删除，其所占用的内存也会随之释放。但是立即删除对cpu是最不友好的。因为删除操作会占用cpu的时间，如果刚好碰上了cpu很忙的时候，比如正在做交集或排序等计算的时候，就会给cpu造成额外的压力，让CPU心累，时时需要删除，忙死。

   <font color = 'red'>这会产生大量的性能消耗，同时也会影响数据的读取操作</font>

   **总结：**对CPU不友好，用处理器性能换取存储空间（拿时间换空间）

2. #### 惰性删除

   数据到达过期时间，不做处理。等下次访问该数据时，如果未过期，返回数据 ;发现已过期，删除，返回不存在。

   <font color = 'red'>惰性删除策略的缺点是，它对内存是最不友好的。</font>

   如果一个键已经过期，而这个键又仍然保留在redis中，那么只要这个过期键不被访问，它所占用的内存就不会释放。在使用惰性删除策略时，如果数据库中有非常多的过期键，而这些过期键又恰好没有被访问到的话，那么它们也许永远也不会被删除(除非用户手动执行FLUSHDB)，我们甚至可以将这种情况看作是一种内存泄漏  - 无用的垃圾数据占用了大量的内存。而服务器却不会自己去释放它们，这对于运行状态非常依赖于内存的Redis服务器来说,肯定不是一个好消息

3. #### 上面两种方案都走极端



